# 2026-02-03
- Added a HEARTBEAT.md build run log section to track successful Node.js builds and failures.
- Reviewed core MD files; noted mojibake/encoding artifacts in AGENTS.md and SOUL.md and missing USER.md fields (pronouns/timezone/notes).
- Normalized core MD files to ASCII, filled USER.md missing fields, and curated MEMORY.md.
- Updated SOUL.md to expand the app-invoicing assistant description and priorities.
- Narrowed the SOUL.md JSDoc rule to exported functions and non-obvious logic.
- Wired chat to a server-side agent that uses docs/README/schema context with OpenAI responses and added env config defaults.
- Added a chat sources viewer with whitelisted doc/schema files and rendered sources links under bot messages.
- Deduped chat sources returned from the agent.
- Removed duplicate docs sidebars by simplifying docs overview and opportunities pages to rely on the shared layout.
- Replaced inline "->" markers with &rarr; entities in docs pages to fix JSX parse errors.
- Removed the duplicate docs header/breadcrumb from the docs layout to avoid stacked headers.
- Moved Docs and Chat links into the user dropdown menu above Logout in the header.
- Moved the Theme toggle under Chat in the dropdown and shifted the icon to the left.
- Renamed "Docs" to "Documentation" in the header dropdown and dashboard sidebar.
- Removed the chat page header title/subtitle block.
- Restored the chat page header title/subtitle block.
- Mapped known docs sources in chat to their /docs routes, with fallback to the source viewer.
- Removed docs/sdks.md from the chat knowledge base sources list.
- Added cache invalidation for knowledge file list changes and fallback to README when no doc chunks match.
- Added query overrides and meta-source filtering so "getting started" resolves to Documentation Overview only.
- Added /docs/faq page backed by docs/faq.md and linked it in the docs sidebar.
- Updated chat source labels to show friendly titles and mapped FAQ to its route.
- Initialized git, committed the repo, and force-pushed main to https://github.com/peichhorst/app-invoicing.
- Fixed prisma import in reporting and updated route param typing for clients/invoices API handlers to satisfy Next's route signature checks.
- Switched clients/invoices route params to Promise-based typing to match existing Next route handlers.
- Exported named prisma and aligned docs source page searchParams typing with Next expectations.
- Normalized product list serialization/parsing to match string storage, updated product APIs and UI to use parsed arrays, and adjusted tag filtering for JSON-string tags.
- Added payment support to the Prisma wrapper and made product normalization parse existing string tag/feature lists before validation.
- Fixed backfill-payments script to coerce Decimal totals to numbers for Prisma payment creation.
- Added a magicLink getter with mock fallback storage to PrismaWrapper to resolve missing prisma.magicLink build errors.
- Renamed the internal PrismaWrapper client field to avoid accessor recursion and made magicLink a concrete delegate property for type-checking.
- Removed README sources from the chat knowledge base and source maps so chat answers only cite docs and schema files.
- Removed schema sources from the chat knowledge base so chat answers only cite docs and reference files.
- Renamed uppercase docs files to kebab-case and updated references in docs index, docs readme, and knowledge base.

- Fixed SubscriptionService invoice status typing and Decimal-to-number conversions for recurring invoice creation, then got a clean Next.js build.
- Added PgBouncer query params to pooled DATABASE_URL settings and documented pooled vs direct URLs in env examples.
- Added a chat bar superadmin online indicator based on /api/me so the chat UI can show when a superadmin is logged in.
- Added a local-only superadmin reply input in the chat bar to echo superadmin messages into the chat stream.
- Wired support chat persistence via /api/chat/messages with polling-based updates, and excluded support chat messages from the internal messaging inbox/status checks.
- Moved the superadmin online badge to the right of the chat send button.
- Added a superadmin-only online users list for support chat, backed by a new /api/chat/online-users endpoint.
- Added user presence tracking (lastSeenAt), a /api/presence/ping endpoint, and superadmin online-user list driven by lastSeenAt with chat-side heartbeat pings.
