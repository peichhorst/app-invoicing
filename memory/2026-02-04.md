# 2026-02-04
- Switched local dev back to SQLite by activating `DATABASE_URL=file:./dev.db` and adjusted the Prisma wrapper to only use the mock client when `USE_MOCK_DB=true`.
- Enabled `USE_MOCK_DB=true` in `.env.local` and commented the SQLite URL to avoid Prisma schema validation failures.
- Switched back to Postgres for local dev, restored Prisma schema provider to `postgresql`, updated `.env.local` with the Supabase transaction pooler URL (pgbouncer/statement cache disabled), and regenerated the Prisma client.
- Commented the SQLite `DATABASE_URL` in `.env` and added missing `applySelect` helper to `src/lib/mock-prisma.ts` to fix TypeScript build errors.
- Added a migration for Invoice `pdfUrl`, applied the column to the Supabase DB via psql, and removed the temporary SQL file.
- Reduced InviteConfirmListener polling frequency, skipped polling when tab is hidden or userId is missing, and removed debug logging to cut down on constant re-rendering noise.
- Normalized Supabase pooler URLs in the Prisma wrapper to auto-apply pgBouncer params and allowed superadmins to receive error details from support chat saves.
- Adjusted Prisma pooler URL normalization to only force pgBouncer params for transaction pooler (port 6543) to avoid breaking session pooler connections.
- Added optional cookie domain support (defaulting to .clientwave.app when NEXT_PUBLIC_APP_URL points there) so auth cookies work across www/apex hosts.
- Deleted BOOTSTRAP.md per workspace rules and pushed commit 2b6f76b with the auth cookie and chat/presence fixes.
- Made invoice numbers optional in InvoiceService and auto-generated them when missing to prevent invoice creation errors.
- Scoped auth cookie domain to production only so localhost logins are not broken by the .clientwave.app domain.
- Added `NEXT_PUBLIC_DISABLE_POLLING` checks to presence, chat, and invite polling to allow disabling all polling locally.
